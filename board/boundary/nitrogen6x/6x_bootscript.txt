#This bootscript will set the envoronment variables the way we want them and then update u-boot
#It will only be called when bootscriptver is not equal to this version

thisver="1.0"

if [$thisver == $bootscriptver]; then
  run bootscript
fi

echo "Updating environment variables"

setenv bootdelay '0'
setenv bootargs 'quiet snd-soc-core.pmdown_time=-1 mxc_hdmi.only_cea=1 console=ttymxc1,115200 vmalloc=400M consoleblank=0 rootwait fixrtc root=/dev/mmcblk1p2'
setenv bootcmd 'script=/6x_bootscript;run runscript'
setenv bootscript 'mmc dev 1 && load mmc 1:1 0x13000000 /imx6q-nitrogen6_som2.dtb && fdt addr 0x13000000 && setenv fdt_high 0xffffffff && fdt resize && run cmd_hdmi && run cmd_lcd && run cmd_lvds && run cmd_lvds2 && load mmc 1:1 0x10800000 /zImage && bootz 0x10800000 - 0x13000000'
setenv bootdevs 'mmc'
setenv cmd_hdmi 'fdt set fb_hdmi status disabled'
setenv cmd_lcd 'fdt set fb_lcd status disabled'
setenv cmd_lvds2 'fdt set fb_lvds2 status disabled'
setenv fb_hdmi 'off'
setenv fdt_addr '0x13000000'
setenv fdt_high '0xffffffff'
setenv fdtaddr '318767104'
setenv filesize 'a925'
setenv panel 'none'
setenv ethprime 

#KOE 15" Display
setenv fb_lvds 'koe:24:65000000,1024,768,220,40,21,7,60,10'
setenv cmd_lvds 'fdt set fb_lvds status okay;fdt set fb_lvds interface_pix_fmt RGB24;fdt set ldb/lvds-channel@0 fsl,data-width <24>;fdt set ldb/lvds-channel@0 fsl,data-mapping spwg;fdt set t_lvds clock-frequency <65002600>;fdt set t_lvds hactive <1024>;fdt set t_lvds vactive <768>;fdt set t_lvds hback-porch <220>;fdt set t_lvds hfront-porch <40>;fdt set t_lvds vback-porch <21>;fdt set t_lvds vfront-porch <7>;fdt set t_lvds hsync-len <60>;fdt set t_lvds vsync-len <10>;'

#Tianma 15" Display
#setenv fb_lvds 'tianma:18:65000000,1024,768,220,40,21,7,60,10'
#setenv cmd_lvds 'fdt set fb_lvds status okay;fdt set fb_lvds interface_pix_fmt RGB666;fdt set ldb/lvds-channel@0 fsl,data-width <18>;fdt set ldb/lvds-channel@0 fsl,data-mapping spwg;fdt set t_lvds clock-frequency <65002600>;fdt set t_lvds hactive <1024>;fdt set t_lvds vactive <768>;fdt set t_lvds hback-porch <220>;fdt set t_lvds hfront-porch <40>;fdt set t_lvds vback-porch <21>;fdt set t_lvds vfront-porch <7>;fdt set t_lvds hsync-len <60>;fdt set t_lvds vsync-len <10>;'

#Finally set the bootscriptver so that we don't run this next time
setenv bootscriptver $thisver

saveenv

echo "Updating U-Boot"

run upgradeu
